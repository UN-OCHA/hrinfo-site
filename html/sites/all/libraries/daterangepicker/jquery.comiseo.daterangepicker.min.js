/*! https://github.com/tamble/jquery-ui-daterangepicker
 * Copyright (c) 2015 Tamble, Inc. Licensed MIT
 */

(function(a,F,P){function L(c,b,e){function h(b){d.button("option","label",b)}var d,g;g="drp_autogen"+z++;a('label[for="'+c.attr("id")+'"]').attr("for",g);d=a('<button type="button"></button>').addClass(b+"-triggerbutton").attr({title:c.attr("title"),tabindex:c.attr("tabindex"),id:g}).button({icons:{secondary:e.icon},label:e.initialText});return{getElement:function(){return d},getLabel:function(){return d.button("option","label")},setLabel:h,reset:function(){c.val("").change();h(e.initialText)},enforceOptions:function(){d.button("option",
{icons:{secondary:e.icon},label:e.initialText})}}}function G(c,b,e){var h,d;(function(){h=a("<div></div>").addClass(c+"-presets");d=a("<ul></ul>");a.each(b.presetRanges,function(){a('<li><a href="#">'+this.text+"</a></li>").data("dateStart",this.dateStart).data("dateEnd",this.dateEnd).click(e).appendTo(d)});h.append(d);d.menu().data("ui-menu").delay=0})();return{getElement:function(){return h}}}function M(c,b){function e(e,d){var c=a.datepicker.parseDate(b.datepickerOptions.dateFormat||a.datepicker._defaults.dateFormat,
e);!f.start||f.end?(f.start=c,f.end=null):c<f.start?(f.end=f.start,f.start=c):f.end=c;if(b.datepickerOptions.hasOwnProperty("onSelect"))b.datepickerOptions.onSelect(e,d)}function h(a){var e=[!0,f.start&&(+a===+f.start||f.end&&f.start<=a&&a<=f.end)?"ui-state-highlight":""],c=[!0,""];b.datepickerOptions.hasOwnProperty("beforeShowDay")&&(c=b.datepickerOptions.beforeShowDay(a));return[e[0]&&c[0],e[1]+" "+c[1]]}function d(){setTimeout(function(){g();d()},moment().endOf("day")-moment())}function g(){l.datepicker("refresh");
l.datepicker("setDate",null)}var l,f={start:null,end:null};l=a("<div></div>",{"class":c+"-calendar ui-widget-content"});l.datepicker(a.extend({},b.datepickerOptions,{beforeShowDay:h,onSelect:e}));d();return{getElement:function(){return l},scrollToRangeStart:function(){f.start&&l.datepicker("setDate",f.start)},getRange:function(){return f},setRange:function(b){f=b;g()},refresh:g,reset:function(){f={start:null,end:null};g()},enforceOptions:function(){l.datepicker("option",a.extend({},b.datepickerOptions,
{beforeShowDay:h,onSelect:e}))}}}function N(c,b,e){var h,d,g,l;h=a("<div></div>").addClass(c+"-buttonpanel");b.applyButtonText&&(d=a('<button type="button" class="ui-priority-primary"></button>').text(b.applyButtonText).button(),h.append(d));b.clearButtonText&&(g=a('<button type="button" class="ui-priority-secondary"></button>').text(b.clearButtonText).button(),h.append(g));b.cancelButtonText&&(l=a('<button type="button" class="ui-priority-secondary"></button>').text(b.cancelButtonText).button(),
h.append(l));e&&(d&&d.click(e.onApply),g&&g.click(e.onClear),l&&l.click(e.onCancel));return{getElement:function(){return h},enforceOptions:function(){d&&d.button("option","label",b.applyButtonText);g&&g.button("option","label",b.clearButtonText);l&&l.button("option","label",b.cancelButtonText)}}}function O(c,b){function e(){if(b.autoFitCalendars){var k=a(F).width(),m=p.outerWidth(!0),c=q.getElement(),d=c.datepicker("option","numberOfMonths"),f=d;if(m>k){for(;1<d&&p.outerWidth(!0)>k;)c.datepicker("option",
"numberOfMonths",--d);d!==f&&(e.monthWidth=(m-p.outerWidth(!0))/(f-d))}else for(;d<e.numberOfMonths&&k-p.outerWidth(!0)>=e.monthWidth;)c.datepicker("option","numberOfMonths",++d);I();C=!1}}function h(){n.getElement().click(J);n.getElement().keydown(z);x.click(r);a(F).resize(function(){t?e():C=!0})}function d(k){var m=b.dateFormat;return a.datepicker.formatDate(m,k.start)+(+k.end!==+k.start?b.rangeSplitter+a.datepicker.formatDate(m,k.end):"")}function g(k){var m=b.altFormat,c={};c.start=a.datepicker.formatDate(m,
k.start);c.end=a.datepicker.formatDate(m,k.end);return JSON.stringify(c)}function l(k){var c=b.altFormat,d=null;if(k)try{d=JSON.parse(k,function(b,k){return b?a.datepicker.parseDate(c,k):k})}catch(e){}return d}function f(){var b=B();b?(n.setLabel(d(b)),q.setRange(b)):q.reset()}function A(a){var m=a||q.getRange();if(m.start&&(m.end||(m.end=m.start),a&&q.setRange(m),n.setLabel(d(m)),c.val(g(m)).change(),b.onChange))b.onChange()}function B(){return l(c.val())}function H(){n.reset();q.reset();c.val("")}
function K(){var c=a(this),d=c.data("dateStart")().startOf("day").toDate(),c=c.data("dateEnd")().startOf("day").toDate();q.setRange({start:d,end:c});b.applyOnMenuSelect&&(r(),A());return!1}function I(){p.position({my:"left top",at:"left bottom"+(0>b.verticalOffset?b.verticalOffset:"+"+b.verticalOffset),of:n.getElement(),collision:"flipfit flipfit",using:function(c,a){var d=u,e,f=a.element.top+a.element.height/2,h=a.target.top+a.target.height/2,g=v;u=a.element.left+a.element.width/2>a.target.left+
a.target.width/2?1:0;u!==d&&(b.mirrorOnCollision&&(e=0===u?w:q,p.children().first().append(e.getElement())),p.removeClass("comiseo-daterangepicker-"+y[d]),p.addClass("comiseo-daterangepicker-"+y[u]));p.css({left:c.left,top:c.top});v=f>h?3:2;v!==g&&(null!==g&&n.getElement().removeClass("comiseo-daterangepicker-"+y[g]),n.getElement().addClass("comiseo-daterangepicker-"+y[v]));d=3===v&&a.element.top-a.target.top!==a.target.height+b.verticalOffset||2===v&&a.target.top-a.element.top!==a.element.height+
b.verticalOffset;n.getElement().toggleClass("comiseo-daterangepicker-vfit",d)}})}function z(b){switch(b.which){case a.ui.keyCode.UP:case a.ui.keyCode.DOWN:b.preventDefault();b.stopPropagation();D();break;case a.ui.keyCode.ESCAPE:b.preventDefault();b.stopPropagation();r();break;case a.ui.keyCode.TAB:r()}}function D(){t||(n.getElement().addClass("comiseo-daterangepicker-active"),x.show(),t=!0,C&&e(),q.scrollToRangeStart(),p.show(),I());if(b.onOpen)b.onOpen()}function r(){t&&(p.hide(),x.hide(),n.getElement().removeClass("comiseo-daterangepicker-active"),
t=!1);if(b.onClose)b.onClose()}function J(){t?r():D()}var p,x,n,w,q,E,t=!1,C=!1,y=["left","right","top","bottom"],u=1,v=null;(function(){n=L(c,"comiseo-daterangepicker",b);w=G("comiseo-daterangepicker",b,K);q=M("comiseo-daterangepicker",b);e.numberOfMonths=b.datepickerOptions.numberOfMonths;e.numberOfMonths instanceof Array&&(b.autoFitCalendars=!1);E=N("comiseo-daterangepicker",b,{onApply:function(){r();A()},onClear:function(){r();H()},onCancel:function(){r();f()}});p=a("<div></div>",{"class":"comiseo-daterangepicker comiseo-daterangepicker-"+
y[u]+" ui-widget ui-widget-content ui-corner-all ui-front"}).append(a("<div></div>",{"class":"comiseo-daterangepicker-main ui-widget-content"}).append(w.getElement()).append(q.getElement())).append(a('<div class="ui-helper-clearfix"></div>').append(E.getElement())).hide();c.hide().after(n.getElement());x=a("<div></div>",{"class":"ui-front comiseo-daterangepicker-mask"}).hide();a("body").append(x).append(p);e();f();h()})();return{toggle:J,destroy:function(){p.remove();n.getElement().remove();c.show()},
open:D,close:r,setRange:A,getRange:B,clearRange:H,reset:f,enforceOptions:function(){var a=w;w=G("comiseo-daterangepicker",b,K);a.getElement().replaceWith(w.getElement());q.enforceOptions();E.enforceOptions();n.enforceOptions();(a=B())&&n.setLabel(d(a))},getContainer:function(){return p}}}var z=0;a.widget("comiseo.daterangepicker",{version:"0.4.3",options:{presetRanges:[{text:"Today",dateStart:function(){return moment()},dateEnd:function(){return moment()}},{text:"Yesterday",dateStart:function(){return moment().subtract("days",
1)},dateEnd:function(){return moment().subtract("days",1)}},{text:"Last 7 Days",dateStart:function(){return moment().subtract("days",6)},dateEnd:function(){return moment()}},{text:"Last Week (Mo-Su)",dateStart:function(){return moment().subtract("days",7).isoWeekday(1)},dateEnd:function(){return moment().subtract("days",7).isoWeekday(7)}},{text:"Month to Date",dateStart:function(){return moment().startOf("month")},dateEnd:function(){return moment()}},{text:"Previous Month",dateStart:function(){return moment().subtract("month",
1).startOf("month")},dateEnd:function(){return moment().subtract("month",1).endOf("month")}},{text:"Year to Date",dateStart:function(){return moment().startOf("year")},dateEnd:function(){return moment()}}],verticalOffset:0,initialText:"Select date range...",icon:"ui-icon-triangle-1-s",applyButtonText:"Apply",clearButtonText:"Clear",cancelButtonText:"Cancel",rangeSplitter:" - ",dateFormat:"M d, yy",altFormat:"yy-mm-dd",mirrorOnCollision:!0,applyOnMenuSelect:!0,autoFitCalendars:!0,onOpen:null,onClose:null,
onChange:null,datepickerOptions:{numberOfMonths:3,maxDate:0}},_create:function(){this._dateRangePicker=O(this.element,this.options)},_destroy:function(){this._dateRangePicker.destroy()},_setOptions:function(a){this._super(a);this._dateRangePicker.enforceOptions()},open:function(){this._dateRangePicker.open()},close:function(){this._dateRangePicker.close()},setRange:function(a){this._dateRangePicker.setRange(a)},getRange:function(){return this._dateRangePicker.getRange()},clearRange:function(){this._dateRangePicker.clearRange()},
widget:function(){return this._dateRangePicker.getContainer()}})})(jQuery,window);
